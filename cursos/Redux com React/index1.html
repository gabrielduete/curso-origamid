<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Redux</title>
    <script src="redux.min.js"></script>
  </head>
  <body>
    <div>
      <h1>Total: <span id="total"></span></h1>
      <button id="button">incrementar</button>
      <button id="abrir">abrir</button>
      <button id="fechar">fechar</button>
    </div>

    <script>
      const INCREMENTAR = 'INCREMENTAR'
      const SOMAR = 'SOMAR'
      const ABRIR = 'ABRIR'
      const FECHAR = 'FECHAR'

      const incrementar = () => {
        return { type: INCREMENTAR }
      }

      const somra = (payload) => {
        return { type: SOMAR, payload }
      }

      const initialState = 0

      const contador = (state = initialState, action) => {
        switch (action.type) {
          case INCREMENTAR:
            return state + 1
          case SOMAR:
            return state + action.payload
          default:
            return state
        }
      }

      const modal = (state = false, action) => {
        switch (action.type) {
          case ABRIR:
            return true
          case FECHAR:
            return false
          default:
            return state
        }
      }

      const reducer = Redux.combineReducers({ contador, modal })

      const store = Redux.createStore(reducer)

      const render = () => {
        const { contador, modal } = store.getState()

        const total = document.getElementById('total')
        total.innerHTML = contador

        if (modal) {
          total.style.display = 'inline-block'
        } else {
          total.style.display = 'none'
        }
      }

      render()

      store.subscribe(render)

      const button = document.getElementById('button')
      button.addEventListener('click', () => store.dispatch(incrementar()))

      const abrir = document.getElementById('abrir')
      const fechar = document.getElementById('fechar')

      abrir.addEventListener('click', () => store.dispatch({ type: ABRIR }))
      fechar.addEventListener('click', () => store.dispatch({ type: FECHAR }))
    </script>
  </body>
</html>
